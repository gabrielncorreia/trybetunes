(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{21:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var a=n(1),c=n.n(a),r=n(22),s=n.n(r),i=(n(21),n(3)),o=n(4),u=n(6),l=n(5),d=n(13),j=n(2),b=n.n(j),h=n(9),m=n(16),O="user",p=function(t){return localStorage.setItem(O,JSON.stringify(t))},f=function(t){return function(e){setTimeout((function(){e(t)}),1500)}},v=function(){return new Promise((function(t){var e=JSON.parse(localStorage.getItem(O));null===e&&(e={}),f(e)(t)}))},x=function(t){return new Promise((function(e){p(Object(m.a)(Object(m.a)({},{name:"",email:"",image:"",description:""}),t)),f("OK")(e)}))},g=n(0),k=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{children:Object(g.jsx)("h5",{children:"Carregando..."})})}}]),n}(a.Component),N=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).fetchUserName=Object(h.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v().then((function(t){return t.name}));case 2:e=t.sent,a.setState({userName:e,logado:!0});case 4:case"end":return t.stop()}}),t)}))),a.welcome=function(t){return Object(g.jsxs)("h3",{"data-testid":"header-user-name",children:["Bem vindo"," ".concat(t)]})},a.state={userName:"",logado:!1},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.fetchUserName()}},{key:"componentDidUpdate",value:function(){this.fetchUserName()}},{key:"componentWillUnmount",value:function(){this.fetchUserName()}},{key:"render",value:function(){var t=this.state,e=t.userName,n=t.logado;return Object(g.jsxs)("header",{"data-testid":"header-component",children:[Object(g.jsx)("h1",{children:"TrybeTunes"}),Object(g.jsxs)("div",{className:"links-div",children:[Object(g.jsx)(d.b,{to:"/",children:Object(g.jsx)("h4",{children:"Login"})}),Object(g.jsx)(d.b,{to:"/search","data-testid":"link-to-search",children:Object(g.jsx)("h4",{children:"Search"})}),Object(g.jsx)(d.b,{to:"/album/:id",children:Object(g.jsx)("h4",{children:"Album"})}),Object(g.jsx)(d.b,{to:"/favorites","data-testid":"link-to-favorites",children:Object(g.jsx)("h4",{children:"Favorites"})}),Object(g.jsx)(d.b,{to:"/profile","data-testid":"link-to-profile",children:Object(g.jsx)("h4",{children:"Profile"})}),Object(g.jsx)(d.b,{to:"/profile/edit",children:Object(g.jsx)("h4",{children:"ProfileEdit"})}),n?this.welcome(e):Object(g.jsx)(k,{})]})]})}}]),n}(a.Component),S=n(7),y=n(15),C=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).onChangeHandler=function(t){var e=t.target,n=e.name,c=e.value;a.setState(Object(y.a)({},n,c),(function(){return a.loginValidation()}))},a.loginValidation=function(){a.state.name.length>=3?a.setState({isButtonDisabled:!1}):a.setState({isButtonDisabled:!0})},a.enterButton=Object(h.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=a.state.name,a.setState({loading:!0},Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({name:e});case 2:a.setState({loading:!1,isUserAuthenticated:!0});case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)}))),a.state={name:"",isButtonDisabled:!0,loading:!1,isUserAuthenticated:!1},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this.state,e=t.isButtonDisabled,n=t.loading,a=t.isUserAuthenticated;return Object(g.jsx)("div",{"data-testid":"page-login",className:"page-div",children:Object(g.jsx)("form",{action:"",children:Object(g.jsxs)("fieldset",{children:[Object(g.jsx)("legend",{children:"Login"}),Object(g.jsxs)("label",{htmlFor:"login-submit-button",children:["Name:",Object(g.jsx)("input",{type:"text",name:"name",onChange:this.onChangeHandler,"data-testid":"login-name-input",id:"login-submit-button"})]}),Object(g.jsx)("div",{children:Object(g.jsx)("button",{type:"button","data-testid":"login-submit-button",disabled:e,onClick:this.enterButton,children:"Entrar"})}),Object(g.jsx)("div",{children:n?Object(g.jsx)(k,{}):Object(g.jsx)("p",{})}),a?Object(g.jsx)(S.a,{to:"/search"}):Object(g.jsx)("p",{})]})})})}}]),n}(a.Component),w=function(){var t=Object(h.a)(b.a.mark((function t(e){var n,a,c,r,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=encodeURI(e).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),t.next=4,fetch(a);case 4:return c=t.sent,t.next=7,c.json();case 7:return r=t.sent,s=r.results,i=s.map((function(t){return{artistId:t.artistId,artistName:t.artistName,collectionId:t.collectionId,collectionName:t.collectionName,collectionPrice:t.collectionPrice,artworkUrl100:t.artworkUrl100,releaseDate:t.releaseDate,trackCount:t.trackCount}})),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=w,U=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).searchChangeHandler=function(t){var e=t.target,n=e.name,c=e.value;a.setState(Object(y.a)({},n,c),(function(){a.state.searchInput.length>=2?a.setState({isButtonDisabled:!1}):a.setState({isButtonDisabled:!0})}))},a.onButtonClick=Object(h.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.state.searchInput,a.setState({artist:e,searchInput:"",loading:!0}),t.next=4,I(e);case 4:(n=t.sent).length>0?a.setState({albums:n,loading:!1,notFound:!1}):a.setState({albums:"",loading:!1,notFound:!0});case 6:case"end":return t.stop()}}),t)}))),a.renderAlbums=function(){var t=a.state,e=t.artist,n=t.albums;return Object(g.jsxs)("div",{className:"results-div",children:[Object(g.jsx)("h4",{children:"Resultado de \xe1lbuns de: ".concat(e)}),Object(g.jsx)("div",{className:"albums-div",children:n.map((function(t){var e=t.artistName,n=t.artworkUrl100,a=t.collectionName,c=t.releaseDate,r=t.collectionPrice,s=t.collectionId;return Object(g.jsx)(d.b,{"data-testid":"link-to-album-".concat(s),to:"/album/".concat(s),children:Object(g.jsxs)("div",{className:"album-div",children:[Object(g.jsx)("h3",{children:e}),Object(g.jsx)("div",{children:Object(g.jsx)("img",{src:n,alt:"",srcSet:""})}),Object(g.jsx)("h4",{children:a}),Object(g.jsx)("h6",{children:c}),Object(g.jsx)("h5",{children:r})]})},s)}))})]})},a.state={searchInput:"",artist:"",isButtonDisabled:!0,albums:[],notFound:!1,loading:!1},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this.state,e=t.searchInput,n=t.isButtonDisabled,a=t.albums,c=t.loading,r=t.notFound;return Object(g.jsxs)("div",{"data-testid":"page-search",className:"page-div",children:[Object(g.jsx)("form",{action:"",className:"search-div",children:c?Object(g.jsx)(k,{}):Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Search a song!"}),Object(g.jsx)("input",{type:"text",name:"searchInput",id:"",value:e,onChange:this.searchChangeHandler,placeholder:"Nome do artista","data-testid":"search-artist-input"}),Object(g.jsx)("button",{type:"button","data-testid":"search-artist-button",disabled:n,onClick:this.onButtonClick,children:"Pesquisar"})]})}),Object(g.jsxs)("div",{children:[r&&Object(g.jsx)("h4",{children:"Nenhum \xe1lbum foi encontrado"}),a.length>0&&this.renderAlbums()]})]})}}]),n}(a.Component),B=function(){var t=Object(h.a)(b.a.mark((function t(e){var n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(e,"&entity=song"));case 2:return n=t.sent,t.next=5,n.json();case 5:return a=t.sent,t.abrupt("return",a.results);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=B,P=n(25),F="favorite_songs";JSON.parse(localStorage.getItem(F))||localStorage.setItem(F,JSON.stringify([]));var A=function(){return JSON.parse(localStorage.getItem(F))},J=function(t){return localStorage.setItem(F,JSON.stringify(t))},H=function(t){return function(e){setTimeout((function(){e(t)}),500)}},T=function(t){return new Promise((function(e){if(t){var n=A();J([].concat(Object(P.a)(n),[t]))}H("OK")(e)}))},E=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).favoriteCheckboxHandler=function(t){var e=a.state.checked;t.target.checked=e,a.setState({checked:!e}),a.setState({loading:!0},Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T(Object(m.a)({},a.props));case 2:if("OK"!==t.sent){t.next=5;break}return t.abrupt("return",a.setState({loading:!1}));case 5:case"end":return t.stop()}}),t)}))))},a.state={loading:!1,checked:!0},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this.props,e=t.trackName,n=t.previewUrl,a=t.trackId,c=t.isChecked,r=this.state.loading;return Object(g.jsxs)("div",{className:"music-card",children:[Object(g.jsx)("h4",{children:e}),Object(g.jsxs)("audio",{"data-testid":"audio-component",src:n,controls:!0,children:[Object(g.jsx)("track",{kind:"captions"}),"O seu navegador n\xe3o suporta o elemento",Object(g.jsx)("code",{children:"audio"}),"."]}),Object(g.jsxs)("label",{htmlFor:"checkbox-music-".concat(a),children:["Favorita",Object(g.jsx)("input",{type:"checkbox",name:"checkbox-music-".concat(a),checked:c,onClick:this.favoriteCheckboxHandler,id:"checkbox-music-".concat(a),"data-testid":"checkbox-music-".concat(a)})]}),r?Object(g.jsx)(k,{}):null]})}}]),n}(a.Component);E.defaultProps={previewUrl:"",trackName:"",trackId:""};var K=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).fetchSongs=Object(h.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.props.match.params.id,t.next=3,D(e);case 3:n=t.sent,a.setState({songs:n.slice(1),loading:!1,artistsName:n[0].artistName,albumName:n[0].collectionCensoredName});case 5:case"end":return t.stop()}}),t)}))),a.fetchFavoriteSong=Object(h.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){var e=A();H(e)(t)}));case 2:e=t.sent,n=e.map((function(t){return t.trackId})),a.setState({favoriteSongs:n});case 5:case"end":return t.stop()}}),t)}))),a.shouldBeChecked=function(t){return!1!==a.state.favoriteSongs.includes(t)||null},a.state={songs:[],loading:!0,artistsName:"",albumName:"",favoriteSongs:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.fetchSongs(),this.fetchFavoriteSong()}},{key:"render",value:function(){var t=this,e=this.state,n=e.songs,a=e.loading,c=e.artistsName,r=e.albumName;return Object(g.jsxs)("div",{"data-testid":"page-album",className:"page-div",children:[Object(g.jsx)("h2",{"data-testid":"artist-name",children:c}),Object(g.jsx)("h3",{"data-testid":"album-name",children:"Collection Name: ".concat(r)}),a?Object(g.jsx)(k,{}):n.map((function(e){var n=e.trackName,a=e.previewUrl,c=e.trackId;return Object(g.jsx)("div",{children:Object(g.jsx)(E,{trackName:n,previewUrl:a,trackId:c,isChecked:t.shouldBeChecked(c)})},c)}))]})}}]),n}(a.Component),M=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{"data-testid":"page-favorites",className:"page-div"})}}]),n}(a.Component),L=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{"data-testid":"page-profile",className:"page-div"})}}]),n}(a.Component),R=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{"data-testid":"page-profile-edit",className:"page-div"})}}]),n}(a.Component),V=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{"data-testid":"page-not-found",className:"page-div"})}}]),n}(a.Component),q=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("main",{className:"content-div",children:Object(g.jsxs)(S.d,{children:[Object(g.jsx)(S.b,{exact:!0,path:"/",component:C}),Object(g.jsx)(S.b,{exact:!0,path:"/search",component:U}),Object(g.jsx)(S.b,{exact:!0,path:"/album/:id",component:K}),Object(g.jsx)(S.b,{exact:!0,path:"/favorites",component:M}),Object(g.jsx)(S.b,{exact:!0,path:"/profile",component:L}),Object(g.jsx)(S.b,{exact:!0,path:"/profile/edit",component:R}),Object(g.jsx)(S.b,{exact:!0,path:"*",component:V})]})})}}]),n}(a.Component),W=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)(d.a,{children:Object(g.jsxs)("div",{children:[Object(g.jsx)(N,{}),Object(g.jsx)(q,{})]})})}}]),n}(c.a.Component),_=W;s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(_,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.3b981782.chunk.js.map